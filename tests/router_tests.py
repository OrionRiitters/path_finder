from unittest import TestCase
from app import app
import handlers.api_handler as api
test_db = 'bucketList_test.db'
test_keys = ['id', 'name', 'summary', 'difficulty', 'stars', 'latitude', 'longitude', 'length', 'imgSmallMed', 'location']
un_wanted_keys = ['type', 'summary', 'starVotes', 'url', 'imgSqSmall', 'imgSmall', 'imgMedium', 'length']
test_trails = {'trails': [{'id': 7075127, 'name': 'REI Southern Snowshoe Tour', 'type': 'Featured Hike', 'summary': "Gentle hills, a varied ecosystem and Eloise Butler Wildflower Garden highlight this beginner's snowshoe/hiking route.", 'difficulty': 'greenBlue', 'stars': 5, 'starVotes': 1, 'location': 'Minneapolis, Minnesota', 'url': 'https://www.hikingproject.com/trail/7075127/rei-southern-snowshoe-tour', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7039841_sqsmall_1509738930.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7039841_small_1509738930.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7039841_smallMed_1509738930.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7039841_medium_1509738930.jpg', 'length': 2.4, 'ascent': 236, 'descent': -237, 'high': 936, 'low': 826, 'longitude': -93.3226, 'latitude': 44.9788, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023119, 'name': 'Minnehaha Falls Regional Park', 'type': 'Featured Hike', 'summary': 'Starting at the iconic Minnehaha Falls, this 2.1-mile hike will take you on quick descent to the scenic river valley.', 'difficulty': 'greenBlue', 'stars': 4.4, 'starVotes': 9, 'location': 'West Saint Paul, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023119/minnehaha-falls-regional-park', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7055826_sqsmall_1550158817.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7055826_small_1550158817.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7055826_smallMed_1550158817.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7055826_medium_1550158817.jpg', 'length': 2.2, 'ascent': 201, 'descent': -201, 'high': 843, 'low': 707, 'longitude': -93.2113, 'latitude': 44.9171, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023436, 'name': 'Quaking Bog Loop', 'type': 'Featured Hike', 'summary': 'This hike will take you through the unique ecosystem that exists within the Quaking Bog in Theodore Wirth Park.', 'difficulty': 'greenBlue', 'stars': 4.6, 'starVotes': 5, 'location': 'Saint Louis Park, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023436/quaking-bog-loop', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7039841_sqsmall_1509738930.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7039841_small_1509738930.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7039841_smallMed_1509738930.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7039841_medium_1509738930.jpg', 'length': 1.6, 'ascent': 203, 'descent': -204, 'high': 992, 'low': 901, 'longitude': -93.3271, 'latitude': 44.9747, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023116, 'name': 'Mud Lake Loop', 'type': 'Featured Hike', 'summary': 'This 4.7-mile, family friendly, partially-paved hike, will take you along a mixture of flat and hilly terrain.', 'difficulty': 'greenBlue', 'stars': 4.5, 'starVotes': 4, 'location': 'Osseo, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023116/mud-lake-loop', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 4.7, 'ascent': 194, 'descent': -196, 'high': 952, 'low': 881, 'longitude': -93.4382, 'latitude': 45.1394, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023110, 'name': 'Pike Island Loop', 'type': 'Featured Hike', 'summary': 'The Pike Island Loop is a relaxed, family-friendly hike around one of Minnesotaâ€™s most significant islands.', 'difficulty': 'green', 'stars': 3.9, 'starVotes': 14, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023110/pike-island-loop', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7034875_sqsmall_1502098034.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7034875_small_1502098034.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7034875_smallMed_1502098034.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7034875_medium_1502098034.jpg', 'length': 3.9, 'ascent': 289, 'descent': -289, 'high': 781, 'low': 695, 'longitude': -93.182, 'latitude': 44.8907, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7017765, 'name': 'Lake Harriet', 'type': 'Trail', 'summary': 'A quiet paved trail around Lake Harriet.', 'difficulty': 'green', 'stars': 5, 'starVotes': 2, 'location': 'Saint Louis Park, Minnesota', 'url': 'https://www.hikingproject.com/trail/7017765/lake-harriet', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7016994_sqsmall_1462501373.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7016994_small_1462501373.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7016994_smallMed_1462501373.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7016994_medium_1462501373.jpg', 'length': 2.9, 'ascent': 59, 'descent': -60, 'high': 881, 'low': 853, 'longitude': -93.3068, 'latitude': 44.9289, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7072312, 'name': 'Osprey Trail', 'type': 'Trail', 'summary': 'Needs Summary', 'difficulty': 'blue', 'stars': 5, 'starVotes': 1, 'location': 'Bloomington, Minnesota', 'url': 'https://www.hikingproject.com/trail/7072312/osprey-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.4, 'ascent': 6, 'descent': -43, 'high': 886, 'low': 843, 'longitude': -93.3727, 'latitude': 44.8415, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7027986, 'name': 'Pike Island Winter Trail', 'type': 'Trail', 'summary': 'The Pike Island Winter Hiking Trail brings you through the interior of the island.', 'difficulty': 'greenBlue', 'stars': 4.5, 'starVotes': 2, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7027986/pike-island-winter-trail', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7028688_sqsmall_1489732039.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7028688_small_1489732039.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7028688_smallMed_1489732039.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7028688_medium_1489732039.jpg', 'length': 2.9, 'ascent': 119, 'descent': -148, 'high': 769, 'low': 701, 'longitude': -93.1772, 'latitude': 44.8909, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7017764, 'name': 'Pond Loop', 'type': 'Trail', 'summary': 'A great, short city loop, complete with creek, pond, and trees.', 'difficulty': 'green', 'stars': 4.5, 'starVotes': 2, 'location': 'Golden Valley, Minnesota', 'url': 'https://www.hikingproject.com/trail/7017764/pond-loop', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7016990_sqsmall_1462498526.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7016990_small_1462498526.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7016990_smallMed_1462498526.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7016990_medium_1462498526.jpg', 'length': 0.8, 'ascent': 28, 'descent': -29, 'high': 882, 'low': 853, 'longitude': -93.3528, 'latitude': 45.0124, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023662, 'name': 'Pike Island Main Loop', 'type': 'Trail', 'summary': 'A great trail encircling Pike Island with views of the mighty Mississippi made mightier by the Minnesota River.', 'difficulty': 'greenBlue', 'stars': 4.3, 'starVotes': 3, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023662/pike-island-main-loop', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7028688_sqsmall_1489732039.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7028688_small_1489732039.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7028688_smallMed_1489732039.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7028688_medium_1489732039.jpg', 'length': 3.2, 'ascent': 200, 'descent': -208, 'high': 775, 'low': 695, 'longitude': -93.1774, 'latitude': 44.8908, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7041937, 'name': 'SW Wirth', 'type': 'Trail', 'summary': 'A great newer trail in the Twin Cities area.', 'difficulty': 'blue', 'stars': 4.3, 'starVotes': 3, 'location': 'Saint Louis Park, Minnesota', 'url': 'https://www.hikingproject.com/trail/7041937/sw-wirth', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7039841_sqsmall_1509738930.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7039841_small_1509738930.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7039841_smallMed_1509738930.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7039841_medium_1509738930.jpg', 'length': 1.9, 'ascent': 311, 'descent': -310, 'high': 989, 'low': 874, 'longitude': -93.3222, 'latitude': 44.9706, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7019239, 'name': 'Mendota Trail', 'type': 'Trail', 'summary': 'An easy trail that follows the river and is relatively lightly used for being in the city.', 'difficulty': 'green', 'stars': 4.2, 'starVotes': 6, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7019239/mendota-trail', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7019865_sqsmall_1467320839.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7019865_small_1467320839.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7019865_smallMed_1467320839.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7019865_medium_1467320839.jpg', 'length': 6, 'ascent': 208, 'descent': -241, 'high': 773, 'low': 697, 'longitude': -93.1678, 'latitude': 44.8879, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023686, 'name': 'Minnehaha Creek Trail', 'type': 'Trail', 'summary': 'A quick descent through the Mississippi River valley and along the final and fastest portion of Minnehaha Creek.', 'difficulty': 'greenBlue', 'stars': 4, 'starVotes': 2, 'location': 'West Saint Paul, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023686/minnehaha-creek-trail', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7025817_sqsmall_1481907025.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7025817_small_1481907025.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7025817_smallMed_1481907025.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7025817_medium_1481907025.jpg', 'length': 0.8, 'ascent': 17, 'descent': -97, 'high': 811, 'low': 722, 'longitude': -93.21, 'latitude': 44.9157, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7055755, 'name': 'Wirth Lake Loop', 'type': 'Trail', 'summary': 'This trail is a nice leg stretcher on a paved pathway with views overlooking the lake while on the boardwalk.', 'difficulty': 'green', 'stars': 3, 'starVotes': 1, 'location': 'Minneapolis, Minnesota', 'url': 'https://www.hikingproject.com/trail/7055755/wirth-lake-loop', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 1.4, 'ascent': 27, 'descent': -27, 'high': 834, 'low': 823, 'longitude': -93.3224, 'latitude': 44.9797, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023684, 'name': 'Mud Lake Loop Trail', 'type': 'Trail', 'summary': 'A semi-paved route around Mud Lake with easy access to other trails in the area.', 'difficulty': 'greenBlue', 'stars': 3, 'starVotes': 1, 'location': 'Osseo, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023684/mud-lake-loop-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 4.7, 'ascent': 166, 'descent': -167, 'high': 950, 'low': 883, 'longitude': -93.4382, 'latitude': 45.1394, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7041939, 'name': 'Glenwood Loop', 'type': 'Trail', 'summary': 'A new trail with some elevation change and banked turns.', 'difficulty': 'blue', 'stars': 3, 'starVotes': 1, 'location': 'Golden Valley, Minnesota', 'url': 'https://www.hikingproject.com/trail/7041939/glenwood-loop', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.8, 'ascent': 157, 'descent': -169, 'high': 948, 'low': 852, 'longitude': -93.3283, 'latitude': 44.98, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7073349, 'name': 'Muskrat Trail', 'type': 'Trail', 'summary': 'Needs Summary', 'difficulty': 'green', 'stars': 3, 'starVotes': 1, 'location': 'Bloomington, Minnesota', 'url': 'https://www.hikingproject.com/trail/7073349/muskrat-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.2, 'ascent': 7, 'descent': -12, 'high': 894, 'low': 882, 'longitude': -93.3724, 'latitude': 44.8413, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7073348, 'name': 'Aspen Trail', 'type': 'Trail', 'summary': 'Needs Summary', 'difficulty': 'green', 'stars': 3, 'starVotes': 1, 'location': 'Bloomington, Minnesota', 'url': 'https://www.hikingproject.com/trail/7073348/aspen-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.3, 'ascent': 17, 'descent': -32, 'high': 893, 'low': 864, 'longitude': -93.3703, 'latitude': 44.8428, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7073347, 'name': 'Oak Trail', 'type': 'Trail', 'summary': 'Needs Summary', 'difficulty': 'green', 'stars': 3, 'starVotes': 1, 'location': 'Bloomington, Minnesota', 'url': 'https://www.hikingproject.com/trail/7073347/oak-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.7, 'ascent': 53, 'descent': -48, 'high': 893, 'low': 856, 'longitude': -93.369, 'latitude': 44.8434, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7073346, 'name': 'Prairie Trail', 'type': 'Trail', 'summary': 'Needs Summary', 'difficulty': 'green', 'stars': 3, 'starVotes': 1, 'location': 'Bloomington, Minnesota', 'url': 'https://www.hikingproject.com/trail/7073346/prairie-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.6, 'ascent': 24, 'descent': -25, 'high': 897, 'low': 873, 'longitude': -93.369, 'latitude': 44.8434, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7016750, 'name': 'The MSPT: Minneapolis West Bank', 'type': 'Trail', 'summary': 'An urban wild trail in the Mississippi River Gorge, Fort Snelling State Park to downtown MPLS.', 'difficulty': 'greenBlue', 'stars': 2.7, 'starVotes': 3, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7016750/the-mspt-minneapolis-west-bank', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7014807_sqsmall_1459910081.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7014807_small_1459910081.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7014807_smallMed_1459910081.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7014807_medium_1459910081.jpg', 'length': 10, 'ascent': 1243, 'descent': -1197, 'high': 849, 'low': 710, 'longitude': -93.182, 'latitude': 44.8907, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023688, 'name': 'Minnehaha Pavilion and Hiawatha Statue Trail', 'type': 'Connector', 'summary': '', 'difficulty': 'green', 'stars': 0, 'starVotes': 0, 'location': 'West Saint Paul, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023688/minnehaha-pavilion-and-hiawatha-statue-trail', 'imgSqSmall': 'https://cdn-files.apstatic.com/hike/7055826_sqsmall_1550158817.jpg', 'imgSmall': 'https://cdn-files.apstatic.com/hike/7055826_small_1550158817.jpg', 'imgSmallMed': 'https://cdn-files.apstatic.com/hike/7055826_smallMed_1550158817.jpg', 'imgMedium': 'https://cdn-files.apstatic.com/hike/7055826_medium_1550158817.jpg', 'length': 0.4, 'ascent': 28, 'descent': -33, 'high': 844, 'low': 813, 'longitude': -93.2113, 'latitude': 44.9171, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7037124, 'name': 'Crossover Trail', 'type': 'Connector', 'summary': '', 'difficulty': 'green', 'stars': 0, 'starVotes': 0, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7037124/crossover-trail', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.2, 'ascent': 29, 'descent': -8, 'high': 751, 'low': 722, 'longitude': -93.1611, 'latitude': 44.8919, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7023663, 'name': 'Fort Snell Memorial Chapel to Pike Loop Connector', 'type': 'Connector', 'summary': '', 'difficulty': 'green', 'stars': 0, 'starVotes': 0, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7023663/fort-snell-memorial-chapel-to-pike-loop-connector', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.2, 'ascent': 11, 'descent': -8, 'high': 748, 'low': 737, 'longitude': -93.1794, 'latitude': 44.8918, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}, {'id': 7037125, 'name': 'Pike Island Alternate', 'type': 'Connector', 'summary': '', 'difficulty': 'green', 'stars': 0, 'starVotes': 0, 'location': 'Mendota Heights, Minnesota', 'url': 'https://www.hikingproject.com/trail/7037125/pike-island-alternate', 'imgSqSmall': '', 'imgSmall': '', 'imgSmallMed': '', 'imgMedium': '', 'length': 0.1, 'ascent': 0, 'descent': -18, 'high': 743, 'low': 725, 'longitude': -93.1772, 'latitude': 44.8909, 'conditionStatus': 'Unknown', 'conditionDetails': None, 'conditionDate': '1970-01-01 00:00:00'}], 'success': 1}
test_location = "fridley, Minnesota"


# tests for the router and handlers
class TestAPILogic(TestCase):
    def test_api_handler(self):
        filtered = api.filter_trails(test_trails, test_location)
        keys = list(filtered[0].keys())
        self.assertListEqual(keys, test_keys)

    def test_make_location(self):
        expected = test_location
        location = api.make_location("fridley", "Minnesota")
        self.assertEqual(expected, location)


class TestRoutes(TestCase):
    def test_get_trails_route(self):
        with app.test_client() as c:
            response = c.get('/get_trails')
            self.assertEquals(response.status_code, 200)

            response = c.get('/')
            self.assertEquals(response.status_code, 200)

